# 二手交易平台二期需求与Draft
## 需求现状
### 当前已实现功能
1. 用户登录
2. 用户图书发布与查看
3. 订单创建，确认，取消，完成

### 当前未实现功能
- [x] 用户注册
- [x] 用户图书图片与外链
- [x] 订单交易方式 
- [x] 消息系统

## 重点关注
主要难点在于：
* 图书图片的存储方案与外链的实现方案
* 订单交易的形式与安全性
* 如何实现一个消息系统，暂时不考虑

## 技术Draft
### 图片存储方案
添加商品功能流程暂定为以下方案：
1. 调用storage/upload接口，上传图片
2. 获得URL，存入URL list
3. 将URL list放在请求中一起发至服务器

存储技术选择，暂时决定使用OSS存储服务，理由：
1. 足够充足的空间，合理的资源计费方式
2. OSS提供的图片处理功能
3. 增强系统性能，减轻服务器负担

### 订单交易形式
线上交易实现较为困难，合理的方案是接入微信支付或者支付宝支付。但是在流程上较为复杂，因此线上交易暂时不在该版本实现，由用户自己协调。

### 消息系统
基于web的即时通讯一般有以下几种实现：
1. 短轮询
2. 长轮询
3. SSE
4. **WebSocket**

这里选用WebSocket，主要考虑到现在html5对webSocket良好的支持性，还有就是消息的即时性和Java springboot本身对webSocket的良好支持。
参考代码：https://github.com/yy1193889747/chat-demo




#flowbook/需求 #flowbook/2